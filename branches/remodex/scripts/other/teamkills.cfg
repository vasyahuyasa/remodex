//initial values
tk_limit_teamplay = 0
tk_limit_instateam = 0
tk_limit_efficteam = 0
tk_limit_tacteam = 0
tk_limit_capture = 0
tk_limit_regencapture = 0
tk_limit_ctf = 0
tk_limit_instactf = 0 
tk_limit_efficctf = 0
tk_limit_protect = 0
tk_limit_instaprotect = 0 
tk_limit_efficprotect = 0
tk_limit_hold = 0
tk_limit_instahold = 0 
tk_limit_effichold = 0
tk_ban_length = 30

tk_onteamkill = [
	mode = (at  $MODENAMES (getmode))
	tk_limit_var = (concatword "tk_limit_" $mode)
	tk_limit = (getalias $tk_limit_var)
	//if limit is setted
	if (!= 0 $tk_limit) [
		tk_count = (getteamkills $arg1)
		if (> $tk_count $tk_limit) [
			(pm $arg1 (format "^f2You reached teamkilling limit and was kicked from server" ))
			s = (format "^f0%1(%2) ^f1was kicked from server for ^f3teamkilling" (getname $arg1) $arg1)
			kick $arg1 (* $tk_ban_length 60000)  //kick and ban for 30 mins
		] [
			if (= $tk_count $tk_limit) [			
				(pm $arg1 (format "^f3LAST WARNING. Dont kill blue players" $tk_count $tk_limit))	
			] [
				(pm $arg1 (format "^f3Warning. ^f1This server has teamkilling limit. If you rich it you will be kicked automatically. You've made ^f3%1 ^f1of ^f3%2 ^f1teamkills" $tk_count $tk_limit))
]
		]
	]
]

addhandler onteamkill tk_onteamkill
